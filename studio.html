<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Webneva Studio – AI-driven site builder</title>
  <link rel="icon" href="images/bgk-remove.webneva.png" />
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- CodeMirror -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/lib/codemirror.min.css" />
  <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/lib/codemirror.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/mode/xml/xml.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/mode/javascript/javascript.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/mode/css/css.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/addon/selection/active-line.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/addon/edit/closetag.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/addon/edit/closebrackets.js"></script>
  <style>
    body{background:#f6f9fc}
    .brand{color:#0f4c81}
    .brand-bg{background:#0f4c81}
    .brand-bg:hover{background:#0c3b63}
    .glass{background:rgba(255,255,255,.85);backdrop-filter:saturate(140%) blur(10px)}
    .device-frame{
      border-radius: 14px; background:#fff; border:1px solid #e5e7eb;
      box-shadow: 0 10px 30px rgba(15,23,42,.08);
    }
    .device-head{
      height: 44px; background:#111827; border-radius:14px 14px 0 0; color:#cbd5e1;
      display:flex; align-items:center; gap:10px; padding:0 14px; font-size:12px;
    }
    .dot{height:10px;width:10px;border-radius:9999px}
    .CodeMirror{height:calc(100vh - 220px); border:1px solid #e5e7eb; border-radius:12px; background:#0b1220; color:#e5e7eb; font-size:14px}
    .CodeMirror-gutters{background:#0b1220; border-right:1px solid #1f2937}
  </style>
</head>
<body class="antialiased">
  <!-- Topbar -->
  <header class="sticky top-0 z-40 bg-white/70 backdrop-blur border-b border-slate-200">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 py-3 flex items-center justify-between">
      <div class="flex items-center gap-3">
        <img src="images/bgk-remove.webneva.png" class="h-7 w-7" alt="Webneva">
        <span class="font-black tracking-tight text-lg brand">Webneva <span class="text-xs align-top bg-emerald-100 text-emerald-700 px-2 py-0.5 rounded-full">LIVE</span></span>
      </div>
      <div class="flex items-center gap-2">
        <button id="newProjectBtn" class="px-3 py-1.5 border rounded-lg bg-white hover:bg-slate-50 text-sm">🆕 Nytt projekt</button>
        <button id="saveProjectBtn" class="px-3 py-1.5 border rounded-lg bg-white hover:bg-slate-50 text-sm">💾 Spara</button>
        <a href="/" class="brand-bg text-white px-3 py-1.5 rounded-lg text-sm">Start­sida</a>

        <!-- Profil dropdown -->
        <div class="relative">
          <button id="profileBtn" class="px-3 py-1.5 border rounded-lg bg-white hover:bg-slate-50 text-sm flex items-center gap-2">
            <span class="inline-block h-6 w-6 rounded-full bg-slate-200"></span> Profil ▾
          </button>
          <div id="profileMenu" class="hidden absolute right-0 mt-2 w-56 bg-white border rounded-xl shadow-lg p-2">
            <div class="px-3 py-2 text-xs text-slate-500">Inställningar</div>
            <button data-action="theme" class="w-full text-left px-3 py-2 rounded hover:bg-slate-50 text-sm">Tema: Ljus / Mörk</button>
            <button data-action="autosave" class="w-full text-left px-3 py-2 rounded hover:bg-slate-50 text-sm">Autospara: Av/På</button>
            <button data-action="export" class="w-full text-left px-3 py-2 rounded hover:bg-slate-50 text-sm">Exportera ZIP</button>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- Workspace -->
  <main class="max-w-7xl mx-auto px-4 sm:px-6 py-5 grid grid-cols-12 gap-5">
    <!-- Left: Editor + AI -->
    <section class="col-span-12 lg:col-span-5 space-y-5">
      <!-- Tabs (pages) -->
      <div class="glass border rounded-2xl p-2 flex flex-wrap items-center gap-2">
        <div id="tabs" class="flex flex-wrap gap-2"></div>
        <button id="addPageBtn" class="ml-auto px-3 py-1.5 text-sm border rounded-lg bg-white hover:bg-slate-50">+ Ny sida</button>
      </div>

      <!-- Editor -->
      <div class="glass border rounded-2xl p-3">
        <div class="flex items-center justify-between mb-2">
          <div class="flex items-center gap-2 text-xs">
            <button id="formatBtn" class="px-2 py-1 border rounded bg-white hover:bg-slate-50">Formatera</button>
            <span class="text-slate-500">Tips: tryck <kbd>Ctrl</kbd> + <kbd>Enter</kbd> för ”Uppdatera förhandsvisning”.</span>
          </div>
          <div class="text-xs text-slate-500" id="fileIndicator">index.html</div>
        </div>
        <textarea id="editor"></textarea>
        <div class="mt-3 flex justify-end">
          <button id="updatePreviewBtn" class="brand-bg text-white px-3 py-1.5 rounded-lg text-sm">🔁 Uppdatera förhandsvisning</button>
        </div>
      </div>

      <!-- AI assistant -->
      <div class="glass border rounded-2xl p-3">
        <h3 class="font-semibold text-slate-800 mb-2">🤖 AI-assistent</h3>
        <div class="text-xs text-slate-500 mb-2">
          Exempel: <em>“Skapa en hemsida för en thairestaurang med sidorna meny, om oss, kontakt.”</em><br>
          Exempel ändring: <em>“Gör knappar röda och lägg till testimonials.”</em>
        </div>
        <div class="grid gap-2">
          <textarea id="aiInput" class="w-full border rounded-lg p-2 text-sm" rows="2" placeholder="Skriv en instruktion till AI…"></textarea>
          <div class="flex gap-2">
            <button id="generateBtn" class="bg-emerald-600 hover:bg-emerald-700 text-white px-3 py-1.5 rounded-lg text-sm">✨ Generera ny sajt</button>
            <button id="transformBtn" class="brand-bg text-white px-3 py-1.5 rounded-lg text-sm">🔧 Förbättra aktuell sida</button>
            <button id="explainBtn" class="px-3 py-1.5 rounded-lg text-sm border bg-white hover:bg-slate-50">📘 Förklara koden</button>
          </div>
        </div>
        <div id="aiLog" class="mt-3 text-xs text-slate-500 whitespace-pre-wrap"></div>
      </div>

      <!-- Explanations / History -->
      <div class="glass border rounded-2xl p-3">
        <div class="flex items-center gap-3 border-b pb-2">
          <button id="tabExplain" class="px-3 py-1.5 rounded bg-slate-100 text-sm">Förklaringar</button>
          <button id="tabHistory" class="px-3 py-1.5 rounded text-sm">Historik</button>
        </div>
        <div id="explanations" class="text-sm text-slate-700 pt-3"></div>
        <div id="history" class="text-sm text-slate-700 pt-3 hidden"></div>
      </div>
    </section>

    <!-- Right: Preview (big “desktop” frame) -->
    <section class="col-span-12 lg:col-span-7">
      <div class="device-frame">
        <div class="device-head">
          <span class="dot bg-red-500"></span>
          <span class="dot bg-yellow-400"></span>
          <span class="dot bg-green-500"></span>
          <span class="ml-3 text-slate-300">webneva-preview</span>
          <span id="liveBadge" class="ml-auto text-emerald-400">● LIVE</span>
        </div>
        <div class="p-0" style="background:#111827">
          <iframe id="previewFrame" title="Preview"
                  style="width:100%;height:calc(100vh - 220px);border:0;background:#fff;border-radius:0 0 14px 14px;"></iframe>
        </div>
      </div>
    </section>
  </main>

  <script type="module" src="/js/studio.js"></script>
</body>
</html>
